# SAST Report: Static Application Security Testing

## GitHub Repository:
**awslabs/genai-bedrock-agent-chatbot**

## Scan Details
- **Tool Used:** Snyk.io
- **Scan Date:** 01 April 2025
- **Report Generated By:** Oladapo Abolurin, Information Security Officer
---

## üìä Executive Summary
Executive Summary
The SAST analysis identified 23 vulnerabilities across dependencies, including 2 Critical, 5 High, 12 Medium, and 4 Low severity issues. The most urgent risks involve heap-based buffer overflow and deserialization of untrusted data, which could lead to remote code execution or system compromise. Immediate action is recommended to upgrade affected packages.

| Severity | Count |
|----------|-------|
| Critical | 2     |
| High     | 5     |
| Medium   | 12    |
| Low      | 4     |

The most urgent risks involve **heap-based buffer overflow** and **deserialization of untrusted data**, which could lead to remote code execution or system compromise. **Immediate action is recommended** to upgrade affected packages.

---

## üîç Key Findings

### Critical Severity (CVSS ‚â• 9.0)
| CVE           | Score | Issue                          | Affected Package (Version) | Impact                               | Fix                          |
|---------------|-------|--------------------------------|----------------------------|--------------------------------------|------------------------------|
| CVE-2023-47248| 9.8   | Deserialization of untrusted data | pyarrow (v12.0.1)          | Arbitrary code execution             | Upgrade to pyarrow ‚â• v14.0.1 |
| CVE-2023-4863 | 9.6   | Heap-based buffer overflow     | pillow (v9.5.0)            | Memory corruption, crashes, code execution | Upgrade to pillow ‚â• v10.0.1 |

### High Severity (CVSS 7.0‚Äì8.9)
| CVE           | Score | Issue                          | Affected Package | Fix                          |
|---------------|-------|--------------------------------|------------------|------------------------------|
| CVE-2023-50447| 8.1   | Eval injection                | pillow           | Upgrade to pillow ‚â• v10.2.0  |
| CVE-2025-1684 | 7.1   | Arbitrary file upload         | streamlit (v1.23.1) | Upgrade to streamlit ‚â• v1.43.2 |
| CVE-2023-44271| 7.5   | Resource exhaustion           | pillow           | Upgrade to pillow ‚â• v10.0.0  |

### Medium Severity (CVSS 4.0‚Äì6.9)
- **Path Traversal** (streamlit)
- **HTTP Request Smuggling** (tornado)
- **ReDoS** (validators)

**Recommendations:**
- Upgrade `streamlit` to v1.37.0+
- Upgrade `tornado` to v6.4.2+
- Upgrade `validators` to v0.21.0+

### Low Severity (CVSS ‚â§ 3.9)
- **Open Redirects** (tornado)
- **Buffer Overflows** (numpy)

**Recommendations:**
- Upgrade `numpy` to v1.22.2+

---

## üìã Detailed Vulnerability Table

| Severity | Vulnerability (CVE/GHSA) | Issue | Affected Package (Version) | Fix Recommendation | Score |
|----------|--------------------------|-------|----------------------------|---------------------|-------|
| Critical | CVE-2023-47248           | Deserialization of untrusted data | pyarrow (12.0.1) | Upgrade pyarrow to ‚â• 14.0.1 | 9.8 |
| Critical | CVE-2023-4863            | Heap-based Buffer Overflow | pillow (9.5.0) | Upgrade pillow to ‚â• 10.0.1 | 9.6 |
| High     | CVE-2023-50447           | Eval Injection | pillow (9.5.0) | Upgrade pillow to ‚â• 10.2.0 | 8.1 |
| High     | CVE-2025-1684            | Arbitrary file upload | streamlit (1.23.1) | Upgrade streamlit to ‚â• 1.43.2 | 7.1 |
| High     | CVE-2023-44271           | Resource Exhaustion | pillow (9.5.0) | Upgrade pillow to ‚â• 10.0.0 | 7.5 |
| High     | ‚Äì                        | Denial of Service (DoS) | pillow (9.5.0) | Upgrade pillow to ‚â• 10.2.0 | 7.5 |
| High     | CVE-2024-28219           | Buffer Overflow | pillow (9.5.0) | Upgrade pillow to ‚â• 10.3.0 | 7.3 |
| Medium   | CVE-2024-35195           | Always-Incorrect Control Flow | requests (2.31.0) | Upgrade requests to ‚â• 2.32.2 | 5.6 |
| Medium   | ‚Äì                        | Improper Log Neutralization | streamlit (<1.23.1) | Upgrade streamlit to ‚â• 1.27.0 | 4.3 |
| Medium   | ‚Äì                        | Directory Traversal | streamlit (1.23.1) | Upgrade streamlit to ‚â• 1.30.0 | 4.3 |
| Medium   | CVE-2024-42474           | Path Traversal | streamlit (1.23.1) | Upgrade streamlit to ‚â• 1.37.0 | 6.0 |
| Medium   | ‚Äì                        | HTTP Request Smuggling | tornado (6.2) | Upgrade tornado to ‚â• 6.4.1 | 5.3 |
| Medium   | ‚Äì                        | CRLF Injection | tornado (6.2) | Upgrade tornado to ‚â• 6.4.1 | 6.5 |
| Medium   | ‚Äì                        | HTTP Request Smuggling | tornado (6.2) | Upgrade tornado to ‚â• 6.3.3 | 6.5 |
| Medium   | CVE-2024-52804           | ReDoS | tornado (6.2) | Upgrade tornado to ‚â• 6.4.2 | 6.9 |
| Medium   | CVE-2024-37891           | Sensitive Info Leak | streamlit (1.23.1), urllib3 (2.0.7) | Upgrade streamlit ‚â• 1.26.19, urllib3 ‚â• 2.2.2 | 6.0 |
| Medium   | CVE-2024-45813           | ReDoS | validators (0.20.0) | Upgrade validators to ‚â• 0.21.0 | 4.6 |
| Medium   | CVE-2024-5569            | Infinite loop | zipp (3.15.0) | Upgrade zipp to ‚â• 3.19.1 | 6.9 |
| Medium   | ‚Äì                        | HTTP Request Smuggling | tornado (6.2.0) | Upgrade tornado to ‚â• 6.3.3 | 5.6 |
| Low      | CVE-2023-28370           | Open Redirect | tornado (6.2) | Upgrade tornado to ‚â• 6.3.2 | 3.4 |
| Low      | CVE-2021-41495           | NULL Pointer Dereference | numpy (1.21.3) | Upgrade numpy to ‚â• 1.22.2 | 3.7 |
| Low      | CVE-2021-41496           | Buffer overflow | numpy (1.21.3) | Upgrade numpy to ‚â• 1.22.0 | 3.7 |
| Low      | CVE-2021-34141           | Denial of Service (DoS) | numpy (1.21.3.0rc1) | Upgrade numpy to ‚â• 1.22.0rc1 | 3.7 |

---

## ‚úÖ Action Plan

### 1. Immediate Fixes (Critical/High)
- **Priority:** Upgrade `pyarrow`, `pillow`, and `streamlit` to patched versions.
- **Timeline:** Within 1 week.

### 2. Scheduled Updates (Medium/Low)
- Address medium- and low-risk issues in the next development cycle.
- **Timeline:** Next sprint.

### 3. Preventive Measures
- Integrate Snyk into CI/CD pipeline to block vulnerable dependencies.
- Review dependency usage to minimize exposure (e.g., replace `pillow` if unused).
- Monitor for new vulnerabilities via automated scans.

---

## üèÅ Conclusion

Proactively upgrading dependencies will mitigate exploitation risks. For assistance, refer to [Snyk‚Äôs remediation guidance](https://snyk.io) or contact the security team.

---

## üìÖ Next Steps
- Apply patches for **Critical/High** issues within **1 week**.
- Schedule **Medium/Low** fixes for the **next sprint**.
- Monitor for new vulnerabilities via automated scans.

---
*Report generated on 01 April 2025.*
